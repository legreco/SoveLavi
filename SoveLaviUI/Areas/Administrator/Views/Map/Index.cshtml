
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/scripts/jquery-1.10.2.js"></script>

<script src="~/scripts/jquery.signalR-2.2.0.min.js"></script>

<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<script>
        google.maps.event.addDomListener(window, 'load', initialize);
            // Reference the auto-generated proxy for the hub.
        var chat = $.connection.mapEventHub;
        var map;

        function initialize() {

            initMap();

        }
        function initMap() {
            var mapProp = {
                center: new google.maps.LatLng(18.997098, -73.635209), //India Lat and Lon
                zoom: 9,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
        }

        function SetMarker(location) {
            if (map != null) {
                var marker = new google.maps.Marker({
                    map: map,
                    position: location,
                    animation: google.maps.Animation.DROP
                });
            }



            var contentString = '<div id="content">' +
      '<div id="siteNotice">' +
      '</div>' +
      '<h1 id="firstHeading" class="firstHeading">Incident</h1>';

            var infowindow = new google.maps.InfoWindow({
                content: contentString
            });
            marker.addListener('click', function () {
                infowindow.open(map, marker);
            });
        }
    // Create a function that the hub can call back to display messages.
     
        chat.client.broadcastMessage = function (eventName, lattitude, longittude) {
            var latAndLonObject = new google.maps.LatLng(lattitude, longittude);
            SetMarker(latAndLonObject);
               
            };
           



        
            // Start the connection.
        $.connection.hub.start()
            .done(function () { console.log('Now connected'); })
            .fail(function () { console.log('Could not connect'); });

        // This optional function html-encodes messages for display in the page.
        
</script>




@*<script type="text/javascript">
    google.maps.event.addDomListener(window, 'load', initialize);
        var gmarkers = [];
        var map;
        var connection;

        function initMap() {
            var mapProp = {
                center: new google.maps.LatLng(18.997098, -73.635209), //India Lat and Lon
                zoom: 9,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
        }

        function initSignalR() {

        }

        function initialize() {

            initMap();

        }

      





</script>*@
<section class="content">
    <div id="googleMap" style="width:auto;height:900px;"></div>
 </section>
